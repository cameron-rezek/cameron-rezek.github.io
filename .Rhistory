variable_comparison_chart <- ggplot(data = variable_comparison_df)
View(variable_comparison_chart)
variable_comparison_chart
variable_comparison_chart <- ggplot(data = variable_comparison_df) +
geom_bar()
variable_comparison_chart
variable_comparison_chart <- ggplot(data = variable_comparison_df. aes(class)) +
geom_bar()
variable_comparison_chart
variable_comparison_chart <- ggplot(data = variable_comparison_df, aes(black)) +
geom_bar()
variable_comparison_chart
variable_comparison_chart <- ggplot(data = variable_comparison_df, aes(South)) +
geom_bar()
variable_comparison_chart
variable_comparison_chart <- ggplot(data = variable_comparison_df, aes(y=percentage)) +
geom_bar()
variable_comparison_chart
variable_comparison_df <- data.frame(matrix(NA,nrow = 4, ncol = 4))
names(variable_comparison_df) <- c("South", "Midwest", "Northeast", "West")
variable_comparison_df$South <- c(black_imprisoned_ratio_to_prison_pop_south,
latinx_imprisoned_ratio_to_prison_pop_south,
white_imprisoned_ratio_to_prison_pop_south,
aapi_imprisoned_ratio_to_prison_pop_south)
variable_comparison_df$Midwest <- c(black_imprisoned_ratio_to_prison_pop_mw,
latinx_imprisoned_ratio_to_prison_pop_mw,
white_imprisoned_ratio_to_prison_pop_mw,
aapi_imprisoned_ratio_to_prison_pop_mw)
variable_comparison_df$Northeast <- c(black_imprisoned_ratio_to_prison_pop_ne,
latinx_imprisoned_ratio_to_prison_pop_ne,
white_imprisoned_ratio_to_prison_pop_ne,
aapi_imprisoned_ratio_to_prison_pop_ne)
variable_comparison_df$West <- c(black_imprisoned_ratio_to_prison_pop_west,
latinx_imprisoned_ratio_to_prison_pop_west,
white_imprisoned_ratio_to_prison_pop_west,
aapi_imprisoned_ratio_to_prison_pop_west)
variable_comparison_df$Race <- c('Black', 'Latinx', 'White', 'AAPI')
variable_comparison_df <- data.frame(matrix(NA,nrow = 4, ncol = 4))
names(variable_comparison_df) <- c("South", "Midwest", "Northeast", "West")
variable_comparison_chart
variable_comparison_chart <- ggplot(data = variable_comparison_df, aes(Race)) +
geom_bar()
variable_comparison_chart
variable_comparison_chart <- ggplot(data = variable_comparison_df, aes('Race')) +
geom_bar()
variable_comparison_chart
south <- c(black_imprisoned_ratio_to_prison_pop_south,
latinx_imprisoned_ratio_to_prison_pop_south,
white_imprisoned_ratio_to_prison_pop_south,
aapi_imprisoned_ratio_to_prison_pop_south)
midwest <- c(black_imprisoned_ratio_to_prison_pop_mw,
latinx_imprisoned_ratio_to_prison_pop_mw,
white_imprisoned_ratio_to_prison_pop_mw,
aapi_imprisoned_ratio_to_prison_pop_mw)
northeast <- c(black_imprisoned_ratio_to_prison_pop_ne,
latinx_imprisoned_ratio_to_prison_pop_ne,
white_imprisoned_ratio_to_prison_pop_ne,
aapi_imprisoned_ratio_to_prison_pop_ne)
west <- c(black_imprisoned_ratio_to_prison_pop_west,
latinx_imprisoned_ratio_to_prison_pop_west,
white_imprisoned_ratio_to_prison_pop_west,
aapi_imprisoned_ratio_to_prison_pop_west)
variable_comparison_df <- data.frame(sputh,midwest,northest,west))
variable_comparison_df <- data.frame(sputh,midwest,northest,west)
variable_comparison_df <- data.frame(south,midwest,northest,west)
variable_comparison_df <- data.frame(south,midwest,northeast,west)
View(variable_comparison_df)
race <- c('Black','Latinx','White','AAPI')
variable_comparison_df <- data.frame(south,midwest,northeast,west,race)
View(variable_comparison_df)
variable_comparison_chart <- ggplot(data = variable_comparison_df, aes(Race)) +
geom_bar()
variable_comparison_chart
variable_comparison_chart <- ggplot(data = variable_comparison_df, aes(race)) +
geom_bar()
variable_comparison_chart
variable_comparison_chart <- ggplot(data = variable_comparison_df, aes(x=race,y=northeast)) +
geom_bar()
variable_comparison_chart
variable_comparison_chart <- ggplot(data = variable_comparison_df, aes(x=race,y=northeast)) +
geom_bar(position='stack')
variable_comparison_chart
vc_final_melt <- melt(variable_comparison_chart, id.vars='race')
vc_final_melt <- melt(variable_comparison_df, id.vars='race')
View(vc_final_melt)
variable_comparison_chart <- barplot(vc_final_melt)
south <- c(black_imprisoned_ratio_to_prison_pop_south,
latinx_imprisoned_ratio_to_prison_pop_south,
white_imprisoned_ratio_to_prison_pop_south,
aapi_imprisoned_ratio_to_prison_pop_south)
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race)) +
geom_col(position = "fill")
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race,
geom_col(position = "fill")
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race,
label = paste0(percentage,"%"))) +
geom_col(position = "fill")
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race,
label = paste0(percentage,"%")), size=4) +
geom_col(position = "fill")
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race,
label = paste0(value,"%")), size=4) +
geom_col(position = "fill")
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race)+
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race)+
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_col(position = "fill")
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_col(position = "fill")+
geom_text(data=vc_final_melt, aes(x=variable,y=value,label=paste0(percentage,"%")),size=4)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_col(position = "fill")+
geom_text(data=vc_final_melt, aes(x=variable,y=value,label=paste0(value,"%")),size=4)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_col(position = "fill")+
geom_text(data=vc_final_melt, aes(x=variable,y=value,label=paste0(value,"%")))
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_col(position = "fill")
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_col(position = "fill")+
scale_y_continuous(labels = scales::percent)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_col(position = "fill")+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(value*100,"%")),
position = position_stack(vjust = 0.5), size = 2)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_col(position = "fill")+
scale_y_continuous(labels = scales::percent)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_col(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(100*value,"%"),y=labelpos),size = 3)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(100*value,"%"),y=value),size = 3)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(100*value,"%"),y=variable),size = 3)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(100*value,"%"),y=percent),size = 3)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(100*value,"%"),y=race),size = 3)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(100*value,"%")),size = 3)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0("%")),size = 3)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(value,"%")),size = 3)
variable_comparison_chart
south <- c(round(black_imprisoned_ratio_to_prison_pop_south,
latinx_imprisoned_ratio_to_prison_pop_south,
white_imprisoned_ratio_to_prison_pop_south,
aapi_imprisoned_ratio_to_prison_pop_south))
black_imprisoned_ratio_to_prison_pop_mw <- round(imprisoned_black_pop_mw / total_imprisoned_pop_mw) * 100)  # Ratio of black prisoners within the total prison population
black_imprisoned_ratio_to_prison_pop_mw <- round(imprisoned_black_pop_mw / total_imprisoned_pop_mw) * 100  # Ratio of black prisoners within the total prison population
black_imprisoned_ratio_to_prison_pop_mw <- round(imprisoned_black_pop_mw / total_imprisoned_pop_mw * 100 ) # Ratio of black prisoners within the total prison population
white_imprisoned_ratio_to_prison_pop_mw <- round(imprisoned_white_pop_mw / total_imprisoned_pop_mw * 100) # Ratio of white prisoners within the total prison population
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(value,"%")),size = 3)
variable_comparison_chart
black_imprisoned_ratio_to_prison_pop_mw <- round(imprisoned_black_pop_mw / total_imprisoned_pop_mw * 100 ) # Ratio of black prisoners within the total prison population
white_imprisoned_ratio_to_prison_pop_mw <- round(imprisoned_white_pop_mw / total_imprisoned_pop_mw * 100) # Ratio of white prisoners within the total prison population
latinx_imprisoned_ratio_to_prison_pop_mw <- round(imprisoned_latinx_pop_mw/ total_imprisoned_pop_west * 100)
aapi_imprisoned_ratio_to_prison_pop_mw <- round(imprisoned_aapi_pop_mw/ total_imprisoned_pop_west * 100)
black_imprisoned_to_black_pop_ratio_mw <- (imprisoned_black_pop_mw / black_pop_mw) * 100 # Ratio of black prisoners within the black population
white_imprisoned_to_white_pop_ratio_mw <- (imprisoned_white_pop_mw / white_pop_mw) * 100 # Ratio of white prisoners within the white population
latinx_imprisoned_to_latinx_pop_ratio_mw <- (imprisoned_latinx_pop_mw / latinx_pop_mw) * 100
northeast_df <- present_day_df %>%
filter(grepl('CT|ME|MA|NH|RI|VT|NJ|NY|PA', state)) # State filter
total_pop_ne <- sum(northeast_df$total_pop_15to64)   # Total Working Population
black_pop_ne <- sum(northeast_df$black_pop_15to64)   # Total Black Working Population
white_pop_ne <- sum(northeast_df$white_pop_15to64)   # Total white working population
latinx_pop_ne <- sum(northeast_df$latinx_pop_15to64, na.rm = TRUE)
aapi_pop_ne <- sum(northeast_df$aapi_pop_15to64, na.rm = TRUE)
imprisoned_black_pop_ne <- sum(northeast_df$black_jail_pop, na.rm = TRUE) +
sum(northeast_df$black_prison_pop, na.rm = TRUE) # Number of imprisoned black people
imprisoned_white_pop_ne <- sum(northeast_df$white_jail_pop, na.rm =TRUE) +
sum(northeast_df$white_prison_pop, na.rm= TRUE) # Number of imprisoned white people
imprisoned_latinx_pop_ne <- sum(northeast_df$latinx_jail_pop, na.rm =TRUE) +
sum(northeast_df$latinx_prison_pop, na.rm= TRUE)
imprisoned_aapi_pop_ne <- sum(northeast_df$aapi_jail_pop, na.rm =TRUE) +
sum(northeast_df$aapi_prison_pop, na.rm= TRUE)
total_imprisoned_pop_ne <- sum(northeast_df$total_jail_pop, na.rm = TRUE) +
sum(northeast_df$total_prison_pop, na.rm = TRUE) # Number of imprisoned Total
black_imprisoned_ratio_to_prison_pop_ne <- (imprisoned_black_pop_ne / total_imprisoned_pop_ne)  # Ratio of black prisoners within the total prison population
white_imprisoned_ratio_to_prison_pop_ne <- (imprisoned_white_pop_ne / total_imprisoned_pop_ne) # Ratio of white prisoners within the total prison population
latinx_imprisoned_ratio_to_prison_pop_ne <- (imprisoned_latinx_pop_ne/ total_imprisoned_pop_ne)
aapi_imprisoned_ratio_to_prison_pop_ne <- (imprisoned_aapi_pop_ne/ total_imprisoned_pop_ne)
black_imprisoned_to_black_pop_ratio_ne <- (imprisoned_black_pop_ne / black_pop_ne) * 100 # Ratio of black prisoners within the black population
white_imprisoned_to_white_pop_ratio_ne <- (imprisoned_white_pop_ne / white_pop_ne) * 100 # Ratio of white prisoners within the white population
latinx_imprisoned_to_latinx_pop_ratio_ne <- (imprisoned_latinx_pop_ne / latinx_pop_ne) * 100
aapi_imprisoned_to_aapi_pop_ratio_ne <- (imprisoned_aapi_pop_ne / aapi_pop_ne) * 100
black_pop_ratio_ne <- (black_pop_ne / total_pop_ne) * 100 # Ratio of black people in the total NE population
white_pop_ratio_ne <- (white_pop_ne / total_pop_ne) * 100 # Ratio of white people in the total NE population
latinx_pop_ratio_ne <- (latinx_pop_ne / total_pop_ne) * 100
aapi_pop_ratio_ne<- (aapi_pop_ne / total_pop_ne) * 100
### South
south_df <- present_day_df %>%
filter(grepl('DE|DC|FL|GA|MD|NC|SC|VA|WV|AL|KY|MS|TN|AR|LA|OK|TX', state)) # State filter
total_pop_south <- sum(south_df$total_pop_15to64, na.rm = TRUE)   # Total Working Population
black_pop_south <- sum(south_df$black_pop_15to64, na.rm = TRUE)   # Total Black Working Population
white_pop_south <- sum(south_df$white_pop_15to64, na.rm = TRUE)   # Total white working population
latinx_pop_south <- sum(south_df$latinx_pop_15to64, na.rm = TRUE)
aapi_pop_south <- sum(south_df$aapi_pop_15to64, na.rm = TRUE)
imprisoned_black_pop_south <- sum(south_df$black_jail_pop, na.rm = TRUE) +
sum(south_df$black_prison_pop, na.rm = TRUE) # Number of imprisoned black people
imprisoned_white_pop_south <- sum(south_df$white_jail_pop, na.rm =TRUE) +
sum(south_df$white_prison_pop, na.rm= TRUE) # Number of imprisoned white people
imprisoned_latinx_pop_south <- sum(south_df$latinx_jail_pop, na.rm =TRUE) +
sum(south_df$latinx_prison_pop, na.rm= TRUE)
imprisoned_aapi_pop_south <- sum(south_df$aapi_jail_pop, na.rm =TRUE) +
sum(south_df$aapi_prison_pop, na.rm= TRUE)
total_imprisoned_pop_south <- sum(south_df$total_jail_pop, na.rm = TRUE) +
sum(south_df$total_prison_pop, na.rm = TRUE) # Number of imprisoned Total
black_imprisoned_ratio_to_prison_pop_south <- (imprisoned_black_pop_south / total_imprisoned_pop_south)  # Ratio of black prisoners within the total prison population
white_imprisoned_ratio_to_prison_pop_south <- (imprisoned_white_pop_south / total_imprisoned_pop_south) # Ratio of white prisoners within the total prison population
latinx_imprisoned_ratio_to_prison_pop_south <- (imprisoned_latinx_pop_south/ total_imprisoned_pop_south)
aapi_imprisoned_ratio_to_prison_pop_south <- (imprisoned_aapi_pop_south/ total_imprisoned_pop_south)
black_imprisoned_to_black_pop_ratio_south <- (imprisoned_black_pop_south / black_pop_south) * 100 # Ratio of black prisoners within the black population
white_imprisoned_to_white_pop_ratio_south <- (imprisoned_white_pop_south / white_pop_south) * 100 # Ratio of white prisoners within the white population
latinx_imprisoned_to_latinx_pop_ratio_south <- (imprisoned_latinx_pop_south / latinx_pop_south) * 100
aapi_imprisoned_to_aapi_pop_ratio_south <- (imprisoned_aapi_pop_south / aapi_pop_south) * 100
black_pop_ratio_south <- (black_pop_south / total_pop_south) * 100 # Ratio of black people in the total NE population
white_pop_ratio_south <- (white_pop_south / total_pop_south) * 100 # Ratio of white people in the total NE population
latinx_pop_ratio_south <- (latinx_pop_south / total_pop_south) * 100
aapi_pop_ratio_south <- (aapi_pop_west / total_pop_south) * 100
### West
west_df <- present_day_df %>%
filter(grepl('AZ|CO|ID|MT|NV|NM|UT|WY|AK|CA|HI|OR|WA', state)) # State filter
total_pop_west <- sum(west_df$total_pop_15to64, na.rm = TRUE)   # Total Working Population
black_pop_west <- sum(west_df$black_pop_15to64, na.rm = TRUE)   # Total Black Working Population
white_pop_west <- sum(west_df$white_pop_15to64, na.rm = TRUE)   # Total white working population
latinx_pop_west <- sum(west_df$latinx_pop_15to64, na.rm = TRUE)
aapi_pop_west <- sum(west_df$aapi_pop_15to64, na.rm = TRUE)
imprisoned_black_pop_west <- sum(west_df$black_jail_pop, na.rm = TRUE) +
sum(west_df$black_prison_pop, na.rm = TRUE) # Number of imprisoned black people
imprisoned_white_pop_west <- sum(west_df$white_jail_pop, na.rm =TRUE) +
sum(west_df$white_prison_pop, na.rm= TRUE) # Number of imprisoned white people
imprisoned_latinx_pop_west <- sum(west_df$latinx_jail_pop, na.rm =TRUE) +
sum(west_df$latinx_prison_pop, na.rm= TRUE)
imprisoned_aapi_pop_west <- sum(west_df$aapi_jail_pop, na.rm =TRUE) +
sum(west_df$aapi_prison_pop, na.rm= TRUE)
total_imprisoned_pop_west<- sum(west_df$total_jail_pop, na.rm = TRUE) +
sum(west_df$total_prison_pop, na.rm = TRUE) # Number of imprisoned Total
black_imprisoned_ratio_to_prison_pop_west <- (imprisoned_black_pop_west/ total_imprisoned_pop_west)  # Ratio of black prisoners within the total prison population
white_imprisoned_ratio_to_prison_pop_west <- (imprisoned_white_pop_west / total_imprisoned_pop_west) # Ratio of white prisoners within the total prison population
latinx_imprisoned_ratio_to_prison_pop_west <- (imprisoned_latinx_pop_west/ total_imprisoned_pop_west)
aapi_imprisoned_ratio_to_prison_pop_west <- (imprisoned_aapi_pop_west/ total_imprisoned_pop_west)
black_imprisoned_to_black_pop_ratio_west <- (imprisoned_black_pop_west / black_pop_west) * 100 # Ratio of black prisoners within the black population
white_imprisoned_to_white_pop_ratio_west <- (imprisoned_white_pop_west / white_pop_west) * 100 # Ratio of white prisoners within the white population
latinx_imprisoned_to_latinx_pop_ratio_west <- (imprisoned_latinx_pop_west / latinx_pop_west) * 100
aapi_imprisoned_to_aapi_pop_ratio_west <- (imprisoned_aapi_pop_west / aapi_pop_west) * 100
black_pop_ratio_west <- (black_pop_west / total_pop_west) * 100 # Ratio of black people in the total west population
white_pop_ratio_west <- (white_pop_west / total_pop_west) * 100 # Ratio of white people in the total NE population
latinx_pop_ratio_west <- (latinx_pop_west / total_pop_west) * 100
aapi_pop_ratio_west <- (aapi_pop_west / total_pop_west) * 100
##Midwest
mw_df <- present_day_df %>%
filter(grepl('IL|IN|MI|OH|WI|IA|KS|MN|MO|NE|ND|SD', state)) # State filter
total_pop_mw <- sum(mw_df$total_pop_15to64, na.rm = TRUE)   # Total Working Population
black_pop_mw <- sum(mw_df$black_pop_15to64, na.rm = TRUE)   # Total Black Working Population
white_pop_mw <- sum(mw_df$white_pop_15to64, na.rm = TRUE)   # Total white working population
latinx_pop_mw <- sum(mw_df$latinx_pop_15to64, na.rm = TRUE)
aapi_pop_mw <- sum(mw_df$aapi_pop_15to64, na.rm = TRUE)
imprisoned_black_pop_mw <- sum(mw_df$black_jail_pop, na.rm = TRUE) +
sum(mw_df$black_prison_pop, na.rm = TRUE) # Number of imprisoned black people
imprisoned_white_pop_mw <- sum(mw_df$white_jail_pop, na.rm =TRUE) +
sum(mw_df$white_prison_pop, na.rm= TRUE) # Number of imprisoned white people
imprisoned_latinx_pop_mw <- sum(mw_df$latinx_jail_pop, na.rm =TRUE) +
sum(mw_df$latinx_prison_pop, na.rm= TRUE)
imprisoned_aapi_pop_mw <- sum(mw_df$aapi_jail_pop, na.rm =TRUE) +
sum(mw_df$aapi_prison_pop, na.rm= TRUE)
total_imprisoned_pop_mw <- sum(mw_df$total_jail_pop, na.rm = TRUE) +
sum(mw_df$total_prison_pop, na.rm = TRUE) # Number of imprisoned Total
black_imprisoned_ratio_to_prison_pop_mw <- (imprisoned_black_pop_mw / total_imprisoned_pop_mw) # Ratio of black prisoners within the total prison population
white_imprisoned_ratio_to_prison_pop_mw <- (imprisoned_white_pop_mw / total_imprisoned_pop_mw) # Ratio of white prisoners within the total prison population
latinx_imprisoned_ratio_to_prison_pop_mw <- (imprisoned_latinx_pop_mw/ total_imprisoned_pop_west)
aapi_imprisoned_ratio_to_prison_pop_mw <- (imprisoned_aapi_pop_mw/ total_imprisoned_pop_west)
black_imprisoned_to_black_pop_ratio_mw <- (imprisoned_black_pop_mw / black_pop_mw) * 100 # Ratio of black prisoners within the black population
white_imprisoned_to_white_pop_ratio_mw <- (imprisoned_white_pop_mw / white_pop_mw) * 100 # Ratio of white prisoners within the white population
latinx_imprisoned_to_latinx_pop_ratio_mw <- (imprisoned_latinx_pop_mw / latinx_pop_mw) * 100
aapi_imprisoned_to_aapi_pop_ratio_mw <- (imprisoned_aapi_pop_mw / aapi_pop_mw) * 100
black_pop_ratio_mw <- (black_pop_mw / total_pop_mw) * 100 # Ratio of black people in the total NE population
white_pop_ratio_mw <- (white_pop_mw / total_pop_mw) * 100 # Ratio of white people in the total NE population
latinx_pop_ratio_mw <- (latinx_pop_mw / total_pop_mw) * 100
aapi_pop_ratio_west <- (aapi_pop_mw / total_pop_mw) * 100
south <- c(black_imprisoned_ratio_to_prison_pop_south,
latinx_imprisoned_ratio_to_prison_pop_south,
white_imprisoned_ratio_to_prison_pop_south,
aapi_imprisoned_ratio_to_prison_pop_south)
midwest <- c(black_imprisoned_ratio_to_prison_pop_mw,
latinx_imprisoned_ratio_to_prison_pop_mw,
white_imprisoned_ratio_to_prison_pop_mw,
aapi_imprisoned_ratio_to_prison_pop_mw)
northeast <- c(black_imprisoned_ratio_to_prison_pop_ne,
latinx_imprisoned_ratio_to_prison_pop_ne,
white_imprisoned_ratio_to_prison_pop_ne,
aapi_imprisoned_ratio_to_prison_pop_ne)
west <- c(black_imprisoned_ratio_to_prison_pop_west,
latinx_imprisoned_ratio_to_prison_pop_west,
white_imprisoned_ratio_to_prison_pop_west,
aapi_imprisoned_ratio_to_prison_pop_west)
race <- c('Black','Latinx','White','AAPI')
variable_comparison_df <- data.frame(south,midwest,northeast,west,race)
vc_final_melt <- melt(variable_comparison_df, id.vars='race')
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(100*value,"%")),size = 3)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(value*100,"%")),
position = position_stack(vjust = 0.5), size = 2)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(value*100,"%")),
position = position_stack(vjust = 0.5), size = 2)+
stat_bin(aes(label = sprintf("%.02f %%", ..count../sum(..count..)*100)),
geom="text")
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)+
geom_text(aes(label = paste0(value*100,"%")),
position = position_stack(vjust = 0.5), size = 2)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent) +
labs(
title = "Percentage of Prisoners by Ethnicity in Each Region"
)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent) +
labs(
title = "Percentage of Prisoners by Ethnicity in Each Region",
subtitle = "(Data from 2015")
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent) +
labs(
title = "Percentage of Prisoners by Ethnicity in Each Region",
subtitle = "(Data from 2015")
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent) +
labs(
title = "Percentage of Prisoners by Ethnicity in Each Region",
subtitle = "(Data from 2015")
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent) +
labs(
title = "Percentage of Prisoners by Ethnicity in Each Region",
subtitle = "(Data from 2015)"
)
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent) +
labs(
title = "Percentage of Prisoners by Ethnicity in Each Region",
subtitle = "(Data from 2015)"
)+
theme(plot.title = element_text(hjust = 0.5))
variable_comparison_chart
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent) +
labs(
title = "Percentage of Prisoners by Ethnicity in Each Region",
subtitle = "(Data from 2015)"
)+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.subtitle = element_text(hjust = 0.5))
variable_comparison_chart
vc_final_melt <- melt(variable_comparison_df, id.vars='race') %>%
mutate(perc = paste0(sprintf("%4.1f", n / sum(n) * 100), "%"))
variable_comparison_df <- data.frame(south,midwest,northeast,west,race)
vc_final_melt <- melt(variable_comparison_df, id.vars='race') %>%
mutate(perc = paste0(sprintf("%4.1f", value / sum(value) * 100), "%"))
View(vc_final_melt)
variable_comparison_df <- data.frame(south,midwest,northeast,west,race)
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent) +
labs(
title = "Percentage of Prisoners by Ethnicity in Each Region",
subtitle = "(Data from 2015)"
)+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.subtitle = element_text(hjust = 0.5))
variable_comparison_chart
over_time_plot <- ggplot(adm_final_melt, aes(x=year, y=value, color=variable))+
geom_line(size=1.3)+
scale_color_manual(values= wes_palette("Rushmore1", n = 4), name="Race",
labels=c("total_prison_adm"="Total",
"black"="Black",
"white"="White",
"latinx"="Latinx"))+
theme_classic()+
labs(
title = "Average Prison Admission in All Counties",
subtitle = "(1985-2015)",
y = "Average"
)+
theme(panel.background = element_rect(fill = 'Azure'))+
theme(panel.grid.major = element_line(color = "grey",
size = 0.5,
linetype = 2))
adm_final_melt <- melt(adm_final, id.vars='year')
over_time_plot <- ggplot(adm_final_melt, aes(x=year, y=value, color=variable))+
geom_line(size=1.3)+
scale_color_manual(values= wes_palette("Rushmore1", n = 4), name="Race",
labels=c("total_prison_adm"="Total",
"black"="Black",
"white"="White",
"latinx"="Latinx"))+
theme_classic()+
labs(
title = "Average Prison Admission in All Counties",
subtitle = "(1985-2015)",
y = "Average"
)+
theme(panel.background = element_rect(fill = 'Azure'))+
theme(panel.grid.major = element_line(color = "grey",
size = 0.5,
linetype = 2))
variable_comparison_chart <- ggplot(vc_final_melt, aes(x = variable, y = value, fill = race))+
geom_bar(position = "fill", stat = "identity", color='black', width=0.9)+
scale_y_continuous(labels = scales::percent) +
labs(
title = "Percentage of Prisoners by Ethnicity in Each Region",
subtitle = "(Data from 2015)"
)+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.subtitle = element_text(hjust = 0.5))
over_time_plot
over_time_plot <- ggplot(adm_final_melt, aes(x=year, y=value, color=variable))+
geom_line(size=1.3)+
scale_color_manual(values= wes_palette("Rushmore1", n = 4), name="Race",
labels=c("total_prison_adm"="Total",
"black"="Black",
"white"="White",
"latinx"="Latinx"))+
theme_classic()+
labs(
title = "Average Prison Admission in All Counties",
subtitle = "(1985-2015)",
y = "Average"
)+
theme(panel.background = element_rect(fill = 'Azure'))+
theme(panel.grid.major = element_line(color = "grey",
size = 0.5,
linetype = 2))+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.subtitle = element_text(hjust = 0.5))
over_time_plot
setwd("~/Info_201/a3-cameron-rezek/docs")
setwd("~/Info_201/cameron-rezek.github.io")
setwd("~/Info_201/cameron-rezek.github.io")
